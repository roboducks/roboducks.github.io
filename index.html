<!DOCTYPE HTML>
<html>
<head>
<script>



window.onload = function () {

var dps = []; // dataPoints
var chart = new CanvasJS.Chart("chartContainer", {
	title :{
		text: "Load"
	},
	axisY: {
    startValue:0,
		includeZero: "true"
	},
	data: [{
		type: "area",
		dataPoints: dps
	}]
});

var xVal = 0;

var updateInterval = 100;
var dataLength = 1000; // number of dataPoints visible at any point
var weight = 0;

var updateChart = function (count) {

	count = count || 1;
  setInterval(function(){
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function(count) {
      count = count || 1;

      if (this.readyState == 4 && this.status == 200) {
       var response = JSON.parse(xhttp.responseText);
       console.log(response.result);
       weight = response.result;
        document.getElementById("weight").innerHTML = weight;
          xhr.timeout = 99; 
      }

  };

  xhttp.open("GET", "https://api.particle.io/v1/devices/2d0047001047343339383037/analogvalue?access_token=f6b3a7fcd7468c38a62e5adc8c0fbb293c741067", true);
  xhttp.send();


}, 100);




	for (var j = 0; j < count; j++) {
		yVal = weight*1 ;
		dps.push({
			x: xVal,
			y: yVal
		});
		xVal++;
	}

	if (dps.length > dataLength) {
		dps.shift();
	}

	chart.render();
};

updateChart(dataLength);
setInterval(function(){updateChart()}, updateInterval);

}
</script>
</head>
<body>

<button type="button">Click Me!</button>


 <p id="weight"></p>
  <br><br>
  <br><br>
<div id="chartContainer" style="height: 300px; width: 100%;"></div>

<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
</body>
</html>
